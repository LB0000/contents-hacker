# CLAUDE.md

## このリポジトリの目的
目的: Product Hunt と Hacker News から話題のプロダクトを取得し、候補30件に圧縮したうえで関門判定・採点・上位3件のMVP計画を1ページで表示するWebアプリ。
ユーザー価値: 海外プロダクトの日本トレース候補を、手作業なしで素早く発見・評価できる。
成功条件: Runボタン1回で30件の候補が関門通過/不通過・スコア付きで表示され、上位3件にMVP計画が併記されている。

## 重要な前提
対象ユーザー: 海外プロダクトを日本向けにトレースしたい起業家・リサーチャー
対象外: DB保存、Sheets/Notion出力、メール送信、X取得、スクレイピング、認証（OAuth/ログイン）、決済、cron、複数ページ
守るべき制約:
- Claude APIキー（ANTHROPIC_API_KEY）を画面・ログ・レスポンスに漏らさない
- Product Hunt / Hacker News の公開APIのみ使用し、利用規約に違反するスクレイピングをしない
- LLMへの入力は短い抜粋のみに絞り、トークン消費を抑える

## 優先順位（迷った時の決め方）
最優先: 正確さ（データ型・スキーマ検証、LLM出力の構造保証）→ 安全（APIキー漏洩防止）→ 最小変更（仕様にない機能を足さない）
次点: ユーザーへのエラー表示の分かりやすさ → 表示速度
避ける: 永続化の追加、ページの増設、外部連携、過剰な抽象化、不要なファイル分割、将来のためだけの拡張

## 作業の進め方（最小の運用ルール）
計画が必要な条件:
(1) 作業が3手順以上
(2) 方式の選択や構成変更が入る
(3) 失敗時の影響が大きい（課金APIの呼び出し変更など）
この場合は、目的・範囲・成功条件・確認手順を短く書いてから着手する。

詰まったら停止:
同じ失敗が続く、前提が崩れた、情報不足が致命的な場合は実装を止めて計画を更新する。

完了条件（検証）:
完了扱いにする前に、再現手順と確認結果を示す。
可能ならテスト、なければログ、なければ手動確認で「動作した根拠」を残す。

## 触ってよい範囲・触ってはいけない範囲
主な編集対象: src/app/, src/components/, src/lib/
編集禁止: .env.local（本番APIキー）、next.config.ts（変更理由が明確な場合を除く）
秘密情報の扱い: .env.local や APIキーは出力しない、ログに残さない、コミットしない

## 実行と確認
ローカル起動: `pnpm dev`
ビルド: `pnpm build`
静的チェック: TypeScriptの型チェックは `pnpm build` で兼ねる
動作確認ポイント: localhost でRunボタンを押し、30件の候補が関門判定・スコア付きで表示され、上位3件にMVP計画が出ること

## 参照資料（詳細はここに置く）
仕様: docs/APP_SPEC.md
